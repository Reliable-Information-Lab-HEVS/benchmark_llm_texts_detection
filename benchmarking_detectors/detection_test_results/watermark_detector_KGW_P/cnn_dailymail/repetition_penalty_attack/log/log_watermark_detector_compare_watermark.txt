Dataset at data/generated_datasets/cnn_dailymail/repetition_penalty_attack/KGW_P/zephyr_compare_watermark exists, loading it
Results for finding the threshold already exist. Loading them...
Threshold for target FPR 0.05: 1.8569533817705188
Classifying the articles...
Test metrics:
accuracy: 0.7800310932798395
precision: 1.0
recall: 0.5603205151139792
f1_score: 0.7179434115811205
fp_rate: 0.0
tp_rate: 0.5603205151139792
std_accuracy: 0.013056832306938774
std_precision: 0.0
std_recall: 0.022583733134996124
std_f1_score: 0.018565363029502208
std_fp_rate: 0.0
std_tp_rate: 0.022583733134996124
TP: 279.509
TN: 498.182
FP: 0.0
FN: 219.309
roc_auc: 0.9975734601733588
fpr: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.00200803 0.00200803
 0.00200803 0.00200803 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.0060241  0.0060241  0.0060241  0.0060241  0.00803213 0.00803213
 0.01204819 0.01204819 0.01606426 0.01807229 0.01807229 0.01807229
 0.01807229 0.02208835 0.02208835 0.02409639 0.02409639 0.04016064
 0.04016064 0.0502008  0.05421687 0.06024096 0.062249   0.06827309
 0.06827309 0.07228916 0.07228916 0.08032129 0.08032129 0.08433735
 0.08433735 0.08835341 0.09036145 0.09036145 0.09638554 0.10040161
 0.10441767 0.10843373 0.11044177 0.11445783 0.1184739  0.12248996
 0.12851406 0.13052209 0.13654618 0.14056225 0.14457831 0.14859438
 0.15060241 0.15662651 0.16666667 0.17068273 0.17269076 0.17670683
 0.18473896 0.18674699 0.19076305 0.19477912 0.21285141 0.21686747
 0.2188755  0.2248996  0.22690763 0.23092369 0.23694779 0.24899598
 0.25301205 0.26305221 0.27108434 0.28714859 0.29518072 0.29919679
 0.30722892 0.30923695 0.31325301 0.32128514 0.32931727 0.3373494
 0.34337349 0.34939759 0.35542169 0.35742972 0.36144578 0.37550201
 0.3875502  0.39558233 0.39959839 0.40160643 0.40562249 0.40763052
 0.41566265 0.42168675 0.42570281 0.42771084 0.43373494 0.43574297
 0.44176707 0.45180723 0.45582329 0.46385542 0.46787149 0.46987952
 0.47791165 0.48795181 0.52208835 0.52409639 0.53012048 0.53212851
 0.55220884 0.55421687 0.56024096 0.56425703 0.57028112 0.57429719
 0.57831325 0.59036145 0.6064257  0.6124498  0.62248996 0.63052209
 0.64859438 0.65261044 0.65662651 0.66064257 0.66465863 0.6686747
 0.67871486 0.68473896 0.68875502 0.69477912 0.70080321 0.70481928
 0.71285141 0.71686747 0.72891566 0.74096386 0.74497992 0.75100402
 0.76305221 0.77108434 0.77911647 0.7811245  0.78714859 0.79116466
 0.79518072 0.80120482 0.80321285 0.80722892 0.80923695 0.81325301
 0.81927711 0.82329317 0.8253012  0.82931727 0.8313253  0.83534137
 0.84136546 0.84538153 0.85140562 0.85542169 0.86746988 0.87148594
 0.90160643 0.90562249 0.90763052 0.91164659 0.92971888 0.93373494
 0.94779116 0.95180723 0.96787149 0.97188755 1.        ]
tpr: [0.         0.00200401 0.03206413 0.03607214 0.04208417 0.06412826
 0.06813627 0.0741483  0.07815631 0.08817635 0.09218437 0.09619238
 0.10220441 0.11823647 0.12224449 0.1242485  0.12825651 0.13026052
 0.13426854 0.14028056 0.14428858 0.15230461 0.15831663 0.16833667
 0.17234469 0.1743487  0.17835671 0.18036072 0.18436874 0.19438878
 0.2004008  0.20440882 0.21442886 0.23046092 0.23647295 0.250501
 0.26252505 0.26452906 0.27054108 0.2745491  0.27655311 0.28056112
 0.28657315 0.28857715 0.3006012  0.30661323 0.31262525 0.31663327
 0.3246493  0.32865731 0.33066132 0.33466934 0.33667335 0.34468938
 0.3507014  0.35671343 0.35871743 0.36272545 0.36472946 0.37274549
 0.3747495  0.37875752 0.38076152 0.38476954 0.38877756 0.39478958
 0.40480962 0.41282565 0.42084168 0.42885772 0.43086172 0.43887776
 0.44288577 0.44689379 0.4509018  0.45891784 0.46292585 0.46693387
 0.47294589 0.4749499  0.48096192 0.48296593 0.49298597 0.49498998
 0.501002   0.50501002 0.50901804 0.51102204 0.51703407 0.52104208
 0.52705411 0.53106212 0.54308617 0.54709419 0.5511022  0.55511022
 0.55711423 0.56513026 0.56713427 0.57114228 0.58116232 0.59118236
 0.59519038 0.59719439 0.60320641 0.60521042 0.60921844 0.61523046
 0.62124248 0.62725451 0.63126253 0.63727455 0.6492986  0.66533066
 0.67134269 0.6753507  0.67935872 0.68537074 0.69539078 0.70140281
 0.70541082 0.71142285 0.71943888 0.7254509  0.73346693 0.73747495
 0.73947896 0.74348697 0.74749499 0.75150301 0.75350701 0.75951904
 0.76152305 0.76553106 0.77154309 0.7755511  0.77755511 0.78557114
 0.79158317 0.7995992  0.80761523 0.81162325 0.81563126 0.82164329
 0.82965932 0.83567134 0.84368737 0.84769539 0.85170341 0.85771543
 0.86372745 0.86773547 0.87174349 0.8757515  0.8757515  0.87775551
 0.88176353 0.88977956 0.89178357 0.89378758 0.8997996  0.90581162
 0.91382766 0.91583166 0.91983968 0.9258517  0.92985972 0.93386774
 0.93386774 0.94789579 0.95190381 0.95390782 0.95390782 0.95791583
 0.95791583 0.96392786 0.96392786 0.96392786 0.96593186 0.97194389
 0.9739479  0.9739479  0.9759519  0.9759519  0.98196393 0.98196393
 0.98396794 0.98396794 0.98396794 0.98396794 0.98597194 0.98597194
 0.98797595 0.98797595 0.98997996 0.98997996 0.99198397 0.99198397
 0.99398798 0.99398798 0.99398798 0.99599198 0.99599198 0.99599198
 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198
 0.99599198 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599
 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599
 0.99799599 1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.        ]
thresholds: [        inf  6.81385144  5.78986377  5.77520053  5.77350269  5.55025312
  5.54482624  5.49584398  5.49125178  5.40598919  5.38516481  5.36363636
  5.36210895  5.24494366  5.24488054  5.22232968  5.22036898  5.21158171
  5.20855376  5.16705068  5.15521786  5.10252039  5.09901951  5.0579321
  5.05756338  5.05068648  5.03053738  5.02517932  5.00370233  5.
  4.97519621  4.95800546  4.95073771  4.87367297  4.87024622  4.79583152
  4.77212698  4.75577452  4.75270821  4.7370088   4.72455591  4.72367773
  4.70678724  4.69485534  4.66973785  4.66217214  4.63104761  4.61880215
  4.57662043  4.56905774  4.5546787   4.5436615   4.53557368  4.52267017
  4.49182264  4.47766736  4.46791497  4.46104258  4.45889229  4.45668812
  4.45435403  4.4446712   4.42635206  4.42138808  4.39155033  4.38592791
  4.36598851  4.35664919  4.33196923  4.31455497  4.31052725  4.31021828
  4.29796783  4.27365779  4.27121098  4.23390197  4.23324391  4.20651124
  4.2         4.19627164  4.19523539  4.16025147  4.15861968  4.1569669
  4.12514324  4.11865303  4.11843884  4.09090909  4.0824829   4.07965248
  4.07940062  4.04509973  4.04145188  4.04061018  4.0055517   4.00454287
  4.00131557  4.          3.98357283  3.97535141  3.96862697  3.92708777
  3.9223227   3.90909091  3.8996021   3.8890873   3.88514345  3.88064504
  3.85905528  3.85695556  3.84900179  3.83672127  3.8         3.71390676
  3.70171618  3.6816376   3.66881139  3.6565517   3.6         3.59092423
  3.59066249  3.57692501  3.56453115  3.55902608  3.53553391  3.53009043
  3.52821143  3.51188458  3.49818355  3.4966291   3.48263017  3.48066721
  3.46890953  3.46410162  3.43375853  3.43246532  3.42065121  3.40168026
  3.36363636  3.352392    3.31662479  3.30237193  3.29252304  3.26376683
  3.2349832   3.23248814  3.19023041  3.18439176  3.16847214  3.16082674
  3.10574778  3.10437887  3.08461529  3.07920144  3.07821537  3.05452076
  3.05108029  2.99688312  2.97112541  2.97044263  2.96926148  2.92118697
  2.91385759  2.89714387  2.89076491  2.83011021  2.80975743  2.66038905
  2.64575131  2.54950976  2.53836541  2.51776298  2.49615088  2.45576245
  2.41495342  2.3763541   2.3539294   2.35339362  2.34520788  2.33108607
  2.31125082  2.20937908  2.20300046  2.20112727  2.15727749  1.97551382
  1.96116135  1.88982237  1.8782971   1.80739223  1.77175914  1.72608848
  1.70856429  1.66003771  1.65703431  1.50850607  1.50755672  1.49676654
  1.49255579  1.48556271  1.4852969   1.46385011  1.4110813   1.39875721
  1.37198868  1.36363636  1.36201045  1.34715063  1.32287566  1.30654916
  1.26750044  1.25723711  1.22293713  1.20185043  1.17217053  1.14415511
  1.12724296  1.11417203  1.05246962  1.0440738   1.03664211  1.03479296
  1.02575529  1.          0.98058068  0.97609216  0.87038828  0.87006284
  0.86204366  0.84664878  0.83205029  0.81818182  0.81150267  0.73645969
  0.73029674  0.67671554  0.6644106   0.58834841  0.57735027  0.56694671
  0.55234477  0.54321448  0.53881591  0.45454545  0.44022545  0.38851434
  0.38138504  0.36822985  0.36514837  0.36214298  0.3592106   0.27975144
  0.26832816  0.20628425  0.19802951  0.19611614  0.19425717  0.19245009
  0.18731716  0.18569534  0.18411492  0.18257419  0.18107149  0.1796053
  0.17817416  0.09578263  0.0949158   0.09407209  0.09245003  0.09166985
  0.09090909  0.086711    0.         -0.08481889 -0.08804509 -0.08873565
 -0.09325048 -0.09407209 -0.0949158  -0.09759001 -0.1754116  -0.17817416
 -0.18107149 -0.18411492 -0.26832816 -0.27050089 -0.27500955 -0.27975144
 -0.3380617  -0.35082321 -0.36514837 -0.36822985 -0.37463432 -0.37796447
 -0.44367825 -0.4472136  -0.45454545 -0.45834925 -0.47036043 -0.47891314
 -0.52223297 -0.53452248 -0.54321448 -0.64715023 -0.65275337 -0.69652603
 -0.72428597 -0.74278135 -0.76277007 -0.76337004 -0.77702869 -0.79555728
 -0.79862086 -0.80498447 -0.80812204 -0.81150267 -0.82502865 -0.83925433
 -0.87705802 -0.88388348 -0.89553347 -0.89802651 -0.91287093 -0.93658581
 -0.94491118 -0.97128586 -0.9918366  -1.00836835 -1.06066017 -1.07349008
 -1.25436302 -1.26750044 -1.2780193  -1.29099445 -1.49676654 -1.4985373
 -1.75655062 -1.76776695 -2.04939015 -2.09090909 -2.73861279]
Test metrics at specific given threshold:
accuracy: 0.9640591775325978
precision: 0.9463974827174736
recall: 0.9839750801956579
f1_score: 0.9647873470434674
fp_rate: 0.05593669356632921
tp_rate: 0.9839750801956579
std_accuracy: 0.005898265431871724
std_precision: 0.009733979713396183
std_recall: 0.005779220435170866
std_f1_score: 0.005836917616715069
std_fp_rate: 0.010319239995966737
std_tp_rate: 0.005779220435170866
TP: 491.3
TN: 469.867
FP: 27.833
FN: 8.0
