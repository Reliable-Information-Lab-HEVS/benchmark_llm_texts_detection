Dataset at data/generated_datasets/cnn_dailymail/repetition_penalty_attack/KGW/zephyr_compare_watermark exists, loading it
Results for finding the threshold already exist. Loading them...
Threshold for target FPR 0.05: 1.8569533817705188
Classifying the articles...
Test metrics:
accuracy: 0.606507522567703
precision: 1.0
recall: 0.21382465286115984
f1_score: 0.3519228260619253
fp_rate: 0.0
tp_rate: 0.21382465286115984
std_accuracy: 0.015361326583116758
std_precision: 0.0
std_recall: 0.018746433173346743
std_f1_score: 0.02543471349601902
std_fp_rate: 0.0
std_tp_rate: 0.018746433173346743
TP: 106.714
TN: 497.974
FP: 0.0
FN: 392.312
roc_auc: 0.9799176666586185
fpr: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.00200803
 0.00200803 0.00200803 0.00200803 0.00200803 0.00200803 0.00200803
 0.00200803 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.0060241  0.0060241  0.0060241
 0.0060241  0.0060241  0.0060241  0.0060241  0.0060241  0.0060241
 0.00803213 0.00803213 0.00803213 0.00803213 0.00803213 0.01004016
 0.01004016 0.01004016 0.01204819 0.01204819 0.01204819 0.01204819
 0.01606426 0.01807229 0.01807229 0.01807229 0.01807229 0.01807229
 0.01807229 0.01807229 0.01807229 0.01807229 0.02008032 0.02008032
 0.02208835 0.02409639 0.02409639 0.02409639 0.02409639 0.02610442
 0.02610442 0.02811245 0.02811245 0.03012048 0.03012048 0.03012048
 0.03212851 0.03212851 0.03413655 0.03413655 0.03614458 0.03815261
 0.04016064 0.04016064 0.04216867 0.04216867 0.04216867 0.04417671
 0.04417671 0.04417671 0.04618474 0.04819277 0.04819277 0.04819277
 0.0502008  0.05421687 0.05421687 0.0562249  0.0562249  0.0562249
 0.0562249  0.0562249  0.0562249  0.06024096 0.06024096 0.062249
 0.062249   0.06626506 0.06626506 0.06827309 0.07028112 0.07228916
 0.07228916 0.07630522 0.07630522 0.07831325 0.07831325 0.08032129
 0.08232932 0.08433735 0.08835341 0.09036145 0.09036145 0.09036145
 0.09638554 0.10040161 0.10240964 0.10240964 0.10441767 0.10843373
 0.11044177 0.11445783 0.1184739  0.12248996 0.12449799 0.12650602
 0.12650602 0.13052209 0.13453815 0.13654618 0.14056225 0.14457831
 0.14457831 0.14859438 0.14859438 0.15060241 0.15060241 0.15662651
 0.1626506  0.1626506  0.16666667 0.17068273 0.17269076 0.17670683
 0.18473896 0.18875502 0.19076305 0.19477912 0.20883534 0.20883534
 0.21285141 0.21686747 0.2188755  0.2248996  0.22690763 0.23092369
 0.23694779 0.24698795 0.24698795 0.24899598 0.25301205 0.26305221
 0.26706827 0.27108434 0.28714859 0.29518072 0.29919679 0.30722892
 0.30923695 0.31325301 0.31325301 0.31927711 0.31927711 0.32128514
 0.32931727 0.3373494  0.34337349 0.34939759 0.35542169 0.35742972
 0.36144578 0.37349398 0.37550201 0.3875502  0.39558233 0.39959839
 0.40160643 0.40562249 0.40763052 0.41566265 0.42168675 0.42570281
 0.42771084 0.43373494 0.43574297 0.44176707 0.44779116 0.44779116
 0.45180723 0.45582329 0.46385542 0.46787149 0.46987952 0.47791165
 0.48795181 0.52208835 0.52409639 0.53012048 0.53212851 0.55220884
 0.55421687 0.56024096 0.56425703 0.57028112 0.57429719 0.57831325
 0.59036145 0.6064257  0.6124498  0.62248996 0.63052209 0.64859438
 0.65261044 0.65662651 0.66064257 0.66465863 0.6686747  0.67871486
 0.68473896 0.68875502 0.69477912 0.70080321 0.70481928 0.71285141
 0.71686747 0.72891566 0.74096386 0.74497992 0.75100402 0.76305221
 0.77108434 0.77911647 0.7811245  0.78714859 0.79116466 0.79518072
 0.80120482 0.80321285 0.80722892 0.80923695 0.81325301 0.81927711
 0.82329317 0.8253012  0.82931727 0.8313253  0.83534137 0.84136546
 0.84538153 0.85140562 0.85542169 0.86746988 0.87148594 0.90160643
 0.90562249 0.90763052 0.91164659 0.92971888 0.93373494 0.94779116
 0.95180723 0.96787149 0.97188755 1.        ]
tpr: [0.         0.00200401 0.04208417 0.04609218 0.05611222 0.06012024
 0.06212425 0.06613226 0.09418838 0.09819639 0.10821643 0.11422846
 0.11823647 0.12224449 0.12625251 0.13426854 0.13827655 0.14629259
 0.15230461 0.16032064 0.16232465 0.16833667 0.17835671 0.18236473
 0.18436874 0.19238477 0.19839679 0.20240481 0.22044088 0.2244489
 0.23046092 0.23246493 0.24048096 0.24849699 0.25250501 0.25651303
 0.26252505 0.26452906 0.27054108 0.2745491  0.27655311 0.29258517
 0.29859719 0.30260521 0.30661323 0.31062124 0.31663327 0.32264529
 0.32865731 0.33266533 0.34068136 0.34268537 0.34869739 0.3507014
 0.35671343 0.36472946 0.37274549 0.37675351 0.38076152 0.38677355
 0.3987976  0.4008016  0.40681363 0.40881764 0.41282565 0.41482966
 0.41883768 0.42685371 0.42885772 0.43687375 0.43887776 0.44288577
 0.45290581 0.47895792 0.48697395 0.49498998 0.49699399 0.501002
 0.50501002 0.50901804 0.51302605 0.51703407 0.51903808 0.52104208
 0.52304609 0.52705411 0.53106212 0.53507014 0.54108216 0.54509018
 0.54709419 0.5490982  0.5511022  0.55511022 0.55711423 0.56513026
 0.56713427 0.57314629 0.5751503  0.57915832 0.58116232 0.58517034
 0.59519038 0.5991984  0.60320641 0.61523046 0.61723447 0.62124248
 0.62725451 0.63126253 0.64729459 0.65330661 0.65531062 0.65931864
 0.66533066 0.66933868 0.6753507  0.67935872 0.68136273 0.68537074
 0.68737475 0.69138277 0.69739479 0.70541082 0.71142285 0.71743487
 0.71743487 0.71943888 0.72344689 0.72745491 0.73146293 0.73146293
 0.73747495 0.73947896 0.73947896 0.74148297 0.74549098 0.749499
 0.75350701 0.75751503 0.76152305 0.76553106 0.77354709 0.7755511
 0.77955912 0.78557114 0.78957916 0.79759519 0.79759519 0.7995992
 0.80160321 0.80160321 0.80561122 0.80761523 0.81362725 0.81563126
 0.82164329 0.82164329 0.82965932 0.82965932 0.83567134 0.83967936
 0.83967936 0.84168337 0.84168337 0.8496994  0.85170341 0.85170341
 0.85370741 0.85771543 0.85771543 0.86372745 0.86573146 0.86573146
 0.86973948 0.87174349 0.8757515  0.8757515  0.87975952 0.88376754
 0.88577154 0.88577154 0.88977956 0.88977956 0.89178357 0.89579158
 0.8997996  0.90380762 0.90581162 0.90581162 0.91182365 0.91382766
 0.91583166 0.91583166 0.91783567 0.91783567 0.91983968 0.91983968
 0.9238477  0.9238477  0.9258517  0.9258517  0.93587174 0.93587174
 0.93787575 0.93787575 0.93787575 0.93787575 0.93987976 0.94388778
 0.94388778 0.94589178 0.94789579 0.9498998  0.9498998  0.95190381
 0.95190381 0.95591182 0.95591182 0.95791583 0.95991984 0.95991984
 0.96192385 0.96593186 0.96593186 0.96793587 0.96793587 0.96793587
 0.96993988 0.96993988 0.9739479  0.9739479  0.9759519  0.9759519
 0.9759519  0.97795591 0.97795591 0.97795591 0.97795591 0.97795591
 0.97795591 0.97795591 0.97995992 0.97995992 0.97995992 0.98196393
 0.98196393 0.98196393 0.98196393 0.98196393 0.98196393 0.98196393
 0.98196393 0.98196393 0.98396794 0.98396794 0.98396794 0.98396794
 0.98396794 0.98597194 0.98597194 0.98597194 0.98597194 0.98597194
 0.98597194 0.98597194 0.98997996 0.98997996 0.99198397 0.99198397
 0.99198397 0.99198397 0.99198397 0.99198397 0.99398798 0.99398798
 0.99398798 0.99398798 0.99799599 0.99799599 0.99799599 0.99799599
 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599
 0.99799599 0.99799599 0.99799599 0.99799599 0.99799599 1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.        ]
thresholds: [        inf  5.83363094  4.88893029  4.82811346  4.71495167  4.66217214
  4.63252819  4.61690258  4.42138808  4.4         4.3503142   4.34659144
  4.31455497  4.31052725  4.29796783  4.27365779  4.26401433  4.23464324
  4.19920627  4.19627164  4.19523539  4.16291928  4.11843884  4.08137938
  4.07965248  4.07940062  4.04061018  4.03985004  3.95131664  3.94180354
  3.9223227   3.8996021   3.88064504  3.84278418  3.83857967  3.81563299
  3.80601028  3.7961199   3.77964473  3.77027231  3.75678081  3.70171618
  3.69088628  3.68229847  3.66899693  3.66881139  3.6565517   3.63676875
  3.62315784  3.60555128  3.59066249  3.58218663  3.57512414  3.56453115
  3.55902608  3.53009043  3.52821143  3.51651158  3.51188458  3.46890953
  3.45026779  3.44865247  3.44035835  3.43451865  3.43246532  3.42194059
  3.42065121  3.41565026  3.40168026  3.39178444  3.38572856  3.38357771
  3.37170892  3.2071349   3.19023041  3.18181818  3.16847214  3.16082674
  3.15584372  3.14757311  3.13222139  3.10437887  3.08157817  3.07821537
  3.06186218  3.05452076  3.03045763  3.02529023  3.00715991  3.
  2.97550979  2.97112541  2.97044263  2.96926148  2.95145915  2.94238979
  2.94174203  2.92118697  2.91623469  2.91460966  2.91385759  2.88675135
  2.83683257  2.83473355  2.83011021  2.80353582  2.8         2.77769623
  2.75080518  2.74562589  2.70426394  2.69430126  2.68660041  2.68105095
  2.66969525  2.66038905  2.65035663  2.64575131  2.62639662  2.62244027
  2.61018852  2.58613097  2.55330763  2.53994634  2.52534324  2.51447423
  2.49615088  2.48759298  2.47487373  2.45576245  2.43975018  2.43512311
  2.42436611  2.41684122  2.41495342  2.4140394   2.39456571  2.35975021
  2.3539294   2.35339362  2.35180217  2.33486893  2.31158698  2.29809704
  2.29174624  2.28858554  2.26778684  2.24457017  2.22349392  2.2223356
  2.20937908  2.20112727  2.18306339  2.17832459  2.15727749  2.14476106
  2.10840654  2.09090909  2.0895781   2.08893187  2.04939015  2.04124145
  2.04091997  2.02526416  2.02503708  2.          1.99178641  1.97565832
  1.97551382  1.96116135  1.95991577  1.9582601   1.94935887  1.94454365
  1.94257172  1.94098992  1.9245009   1.90957185  1.90692518  1.89057066
  1.88982237  1.8782971   1.87317162  1.87212563  1.86344867  1.85421014
  1.83679933  1.82574186  1.81986994  1.80739223  1.78226558  1.77175914
  1.76504522  1.74831455  1.72727273  1.72608848  1.70084013  1.66003771
  1.64345203  1.61356859  1.6         1.59922548  1.51185789  1.50850607
  1.4985373   1.49676654  1.48556271  1.4852969   1.47799392  1.46385011
  1.4110813   1.39875721  1.37504775  1.37281295  1.37198868  1.36363636
  1.36201045  1.34715063  1.32287566  1.30654916  1.29354835  1.28880447
  1.26867009  1.25723711  1.23743687  1.22293713  1.20185043  1.17217053
  1.15356346  1.14415511  1.13389342  1.12724296  1.12390297  1.11417203
  1.08642895  1.07349008  1.05246962  1.0440738   1.03664211  1.03479296
  1.02575529  0.99014754  0.98058068  0.97609216  0.90535746  0.88679635
  0.87038828  0.87006284  0.86204366  0.84664878  0.83205029  0.81818182
  0.81150267  0.75592895  0.74278135  0.73645969  0.73029674  0.67671554
  0.6704784   0.6644106   0.58834841  0.57735027  0.56694671  0.55234477
  0.54321448  0.53881591  0.4975186   0.47036043  0.46225016  0.45454545
  0.44022545  0.38851434  0.38138504  0.36822985  0.36514837  0.36214298
  0.3592106   0.2847474   0.27975144  0.26832816  0.20628425  0.19802951
  0.19611614  0.19425717  0.19245009  0.18731716  0.18569534  0.18411492
  0.18257419  0.18107149  0.1796053   0.17817416  0.17149859  0.09950372
  0.09578263  0.0949158   0.09407209  0.09245003  0.09166985  0.09090909
  0.086711    0.         -0.08481889 -0.08804509 -0.08873565 -0.09325048
 -0.09407209 -0.0949158  -0.09759001 -0.1754116  -0.17817416 -0.18107149
 -0.18411492 -0.26832816 -0.27050089 -0.27500955 -0.27975144 -0.3380617
 -0.35082321 -0.36514837 -0.36822985 -0.37463432 -0.37796447 -0.44367825
 -0.4472136  -0.45454545 -0.45834925 -0.47036043 -0.47891314 -0.52223297
 -0.53452248 -0.54321448 -0.64715023 -0.65275337 -0.69652603 -0.72428597
 -0.74278135 -0.76277007 -0.76337004 -0.77702869 -0.79555728 -0.79862086
 -0.80498447 -0.80812204 -0.81150267 -0.82502865 -0.83925433 -0.87705802
 -0.88388348 -0.89553347 -0.89802651 -0.91287093 -0.93658581 -0.94491118
 -0.97128586 -0.9918366  -1.00836835 -1.06066017 -1.07349008 -1.25436302
 -1.26750044 -1.2780193  -1.29099445 -1.49676654 -1.4985373  -1.75655062
 -1.76776695 -2.04939015 -2.09090909 -2.73861279]
Test metrics at specific given threshold:
accuracy: 0.9177562688064193
precision: 0.940762057689503
recall: 0.8919060790303283
f1_score: 0.915599946353208
fp_rate: 0.05631942327820542
tp_rate: 0.8919060790303283
std_accuracy: 0.008854530003630737
std_precision: 0.010973294153781028
std_recall: 0.014142245485244969
std_f1_score: 0.0093929021629768
std_fp_rate: 0.01050850735044076
std_tp_rate: 0.014142245485244969
TP: 445.182
TN: 469.821
FP: 28.038
FN: 53.959
