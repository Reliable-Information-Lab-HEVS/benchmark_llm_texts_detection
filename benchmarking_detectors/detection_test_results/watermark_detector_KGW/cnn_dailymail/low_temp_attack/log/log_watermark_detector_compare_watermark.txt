Dataset at data/generated_datasets/cnn_dailymail/low_temp_attack/KGW/zephyr_compare_watermark exists, loading it
Results for finding the threshold already exist. Loading them...
Threshold for target FPR 0.05: 1.8569533817705188
Classifying the articles...
Test metrics:
accuracy: 0.5994674022066199
precision: 1.0
recall: 0.19896268080551718
f1_score: 0.3315053269253165
fp_rate: 0.0
tp_rate: 0.19896268080551718
std_accuracy: 0.01508991793846898
std_precision: 0.0
std_recall: 0.018231577736810996
std_f1_score: 0.025392312429714306
std_fp_rate: 0.0
std_tp_rate: 0.018231577736810996
TP: 99.21
TN: 498.459
FP: 0.0
FN: 399.331
roc_auc: 0.9747909473565606
fpr: [0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.
 0.         0.         0.         0.         0.         0.00200803
 0.00200803 0.00200803 0.00200803 0.00200803 0.00200803 0.00200803
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606 0.00401606
 0.00401606 0.0060241  0.0060241  0.0060241  0.0060241  0.0060241
 0.0060241  0.0060241  0.0060241  0.0060241  0.0060241  0.0060241
 0.00803213 0.00803213 0.00803213 0.00803213 0.00803213 0.00803213
 0.01004016 0.01004016 0.01004016 0.01204819 0.01204819 0.01204819
 0.01204819 0.01606426 0.01807229 0.01807229 0.01807229 0.01807229
 0.01807229 0.01807229 0.01807229 0.01807229 0.01807229 0.01807229
 0.02008032 0.02008032 0.02208835 0.02208835 0.02409639 0.02409639
 0.02409639 0.02409639 0.02610442 0.02610442 0.02610442 0.03012048
 0.03012048 0.03012048 0.03212851 0.03212851 0.03413655 0.03413655
 0.03614458 0.03614458 0.03815261 0.04016064 0.04216867 0.04417671
 0.04417671 0.04618474 0.04618474 0.04819277 0.04819277 0.0502008
 0.05421687 0.05421687 0.0562249  0.0562249  0.06024096 0.06024096
 0.06024096 0.062249   0.062249   0.06626506 0.06626506 0.06827309
 0.06827309 0.07028112 0.07228916 0.07228916 0.07228916 0.07429719
 0.07429719 0.07831325 0.07831325 0.08433735 0.08835341 0.09036145
 0.09036145 0.09437751 0.09437751 0.09638554 0.09638554 0.10040161
 0.10040161 0.10441767 0.10843373 0.11044177 0.11445783 0.11646586
 0.11646586 0.1184739  0.12248996 0.12248996 0.13654618 0.14056225
 0.14257028 0.14257028 0.14457831 0.14457831 0.14859438 0.14859438
 0.15060241 0.15662651 0.15863454 0.16064257 0.16064257 0.16666667
 0.17068273 0.17269076 0.17670683 0.18473896 0.19076305 0.19477912
 0.19477912 0.21285141 0.21686747 0.2188755  0.2188755  0.2248996
 0.22690763 0.23092369 0.23694779 0.24096386 0.24096386 0.24899598
 0.25301205 0.25502008 0.26305221 0.26706827 0.27108434 0.2811245
 0.28313253 0.28714859 0.28714859 0.29518072 0.29919679 0.30722892
 0.30923695 0.31325301 0.31325301 0.31927711 0.31927711 0.32128514
 0.32931727 0.3373494  0.34337349 0.34538153 0.34738956 0.34939759
 0.35542169 0.35742972 0.36144578 0.37550201 0.3875502  0.39558233
 0.39959839 0.40160643 0.40562249 0.40763052 0.41566265 0.42168675
 0.42570281 0.42771084 0.43373494 0.43574297 0.44176707 0.45180723
 0.45582329 0.46385542 0.46787149 0.46987952 0.47791165 0.48795181
 0.52208835 0.52409639 0.53012048 0.53212851 0.55220884 0.55421687
 0.56024096 0.56425703 0.57028112 0.57429719 0.57831325 0.59036145
 0.6064257  0.6124498  0.62248996 0.63052209 0.64859438 0.65261044
 0.65662651 0.66064257 0.66465863 0.6686747  0.67871486 0.68473896
 0.68875502 0.69477912 0.70080321 0.70481928 0.70682731 0.70682731
 0.71285141 0.71686747 0.72289157 0.72891566 0.74096386 0.74497992
 0.75100402 0.76305221 0.77108434 0.77911647 0.7811245  0.78714859
 0.79116466 0.79518072 0.80120482 0.80321285 0.80722892 0.80923695
 0.81325301 0.81927711 0.82329317 0.8253012  0.82931727 0.8313253
 0.83534137 0.84136546 0.84538153 0.85140562 0.85542169 0.86746988
 0.87148594 0.90160643 0.90562249 0.90763052 0.91164659 0.92971888
 0.93373494 0.94779116 0.95180723 0.96787149 0.97188755 1.        ]
tpr: [0.         0.00200401 0.01202405 0.01603206 0.0240481  0.02805611
 0.03006012 0.03406814 0.03607214 0.04208417 0.06212425 0.06613226
 0.08016032 0.08416834 0.09018036 0.09218437 0.1002004  0.10220441
 0.11022044 0.12024048 0.1242485  0.13226453 0.13627255 0.15230461
 0.15631263 0.17234469 0.17635271 0.18637275 0.19238477 0.21442886
 0.22044088 0.2244489  0.22845691 0.23446894 0.23847695 0.25250501
 0.25851703 0.26252505 0.26853707 0.27655311 0.28056112 0.28256513
 0.29058116 0.29258517 0.29659319 0.29859719 0.30260521 0.31462926
 0.32264529 0.32865731 0.33066132 0.34268537 0.34669339 0.35470942
 0.35871743 0.36072144 0.36873747 0.37074148 0.37875752 0.38076152
 0.38476954 0.38677355 0.39078156 0.39278557 0.3987976  0.40280561
 0.40681363 0.41082164 0.42084168 0.44088176 0.44689379 0.4509018
 0.45290581 0.45691383 0.47094188 0.47895792 0.48897796 0.48897796
 0.49699399 0.501002   0.51302605 0.51703407 0.52104208 0.52705411
 0.52705411 0.53106212 0.53507014 0.53707415 0.54308617 0.5511022
 0.56513026 0.56913828 0.57314629 0.58116232 0.58717435 0.59519038
 0.61122244 0.61523046 0.61723447 0.62124248 0.62324649 0.63126253
 0.63927856 0.64328657 0.6492986  0.65130261 0.65531062 0.66332665
 0.66733467 0.67134269 0.6753507  0.68136273 0.68537074 0.68737475
 0.68737475 0.68937876 0.6993988  0.70140281 0.70541082 0.70741483
 0.70941884 0.71142285 0.71543086 0.71743487 0.72344689 0.72745491
 0.73146293 0.73547094 0.73747495 0.74348697 0.749499   0.75350701
 0.75551102 0.76152305 0.76753507 0.77154309 0.7755511  0.77955912
 0.78156313 0.78356713 0.78557114 0.78757515 0.78757515 0.78957916
 0.79559118 0.80360721 0.80561122 0.81763527 0.82164329 0.82164329
 0.8256513  0.83767535 0.83967936 0.84168337 0.84368737 0.8496994
 0.85370741 0.85571142 0.85771543 0.86172345 0.86172345 0.86372745
 0.86973948 0.87174349 0.87374749 0.8757515  0.87975952 0.87975952
 0.87975952 0.88176353 0.88176353 0.88577154 0.88577154 0.88977956
 0.89378758 0.89378758 0.89579158 0.89579158 0.89779559 0.89779559
 0.90380762 0.90380762 0.90581162 0.90981964 0.91182365 0.91182365
 0.91382766 0.91382766 0.91983968 0.91983968 0.91983968 0.91983968
 0.9258517  0.9258517  0.93186373 0.93186373 0.93386774 0.93386774
 0.93787575 0.93787575 0.93787575 0.93787575 0.93787575 0.93787575
 0.94188377 0.94388778 0.94388778 0.94589178 0.94589178 0.94789579
 0.94789579 0.9498998  0.9498998  0.95390782 0.95591182 0.95791583
 0.95791583 0.95991984 0.96192385 0.96192385 0.96392786 0.96392786
 0.96392786 0.96392786 0.96593186 0.96793587 0.96793587 0.96793587
 0.96993988 0.96993988 0.96993988 0.97194389 0.9739479  0.9739479
 0.9739479  0.9739479  0.9739479  0.9739479  0.9759519  0.9759519
 0.9759519  0.97795591 0.97795591 0.97995992 0.97995992 0.97995992
 0.98196393 0.98196393 0.98396794 0.98396794 0.98396794 0.98396794
 0.98396794 0.98396794 0.98597194 0.98597194 0.98997996 0.98997996
 0.98997996 0.98997996 0.98997996 0.98997996 0.99198397 0.99198397
 0.99198397 0.99198397 0.99198397 0.99198397 0.99198397 0.99198397
 0.99198397 0.99198397 0.99198397 0.99398798 0.99398798 0.99398798
 0.99398798 0.99398798 0.99398798 0.99398798 0.99398798 0.99398798
 0.99398798 0.99398798 0.99398798 0.99398798 0.99398798 0.99398798
 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198
 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198
 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198
 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198
 0.99599198 0.99599198 0.99599198 0.99599198 0.99599198 0.99799599
 0.99799599 0.99799599 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.        ]
thresholds: [        inf  5.64288094  5.41287471  5.41020058  5.2         5.1120772
  5.09901951  5.07000178  5.01377413  5.          4.82811346  4.81818182
  4.63636364  4.61880215  4.60953226  4.57662043  4.5436615   4.53557368
  4.52267017  4.45668812  4.45454545  4.38592791  4.38269324  4.21724853
  4.2038078   4.07965248  4.05052832  4.01663209  4.00454287  3.8890873
  3.88514345  3.87835876  3.87717943  3.84900179  3.82326971  3.75846384
  3.74165739  3.71390676  3.70171618  3.67373793  3.66881139  3.65148372
  3.62142984  3.60984872  3.60555128  3.60147029  3.59210604  3.59066249
  3.54964787  3.54395726  3.53553391  3.51188458  3.5028664   3.49818355
  3.48263017  3.48066721  3.46069039  3.45237873  3.42065121  3.41565026
  3.4         3.36363636  3.352392    3.34251609  3.32205299  3.31662479
  3.31406862  3.30938061  3.26376683  3.21269802  3.2071349   3.19023041
  3.18439176  3.18198052  3.13049517  3.10811476  3.07920144  3.07821537
  3.07726587  3.05452076  3.02529023  3.01232038  3.          2.9793812
  2.97112541  2.95932015  2.95160973  2.94583878  2.94174203  2.92827648
  2.8614629   2.84176534  2.83011021  2.81818182  2.80975743  2.80353582
  2.72939781  2.72809052  2.70346534  2.69430126  2.68660041  2.66969525
  2.64850874  2.64575131  2.62244027  2.61018852  2.58613097  2.57438361
  2.57333388  2.55330763  2.53994634  2.53500089  2.52534324  2.51447423
  2.49615088  2.47900273  2.47508594  2.46598481  2.4633232   2.45676907
  2.43512311  2.41883159  2.41684122  2.41495342  2.4         2.3763541
  2.37289499  2.3539294   2.35339362  2.35180217  2.3162641   2.30940108
  2.29809704  2.29174624  2.26300953  2.25417409  2.23606798  2.22834406
  2.22349392  2.21839127  2.20937908  2.20300046  2.20112727  2.19089023
  2.18306339  2.15526362  2.14476106  2.11057941  2.10840654  2.08893187
  2.06048879  2.04264872  2.04091997  2.03014663  2.02503708  1.99323179
  1.99178641  1.98029509  1.97565832  1.97551382  1.95991577  1.94454365
  1.92506684  1.9245009   1.91485422  1.90957185  1.89350623  1.88982237
  1.8782971   1.87317162  1.87212563  1.81986994  1.80739223  1.80340019
  1.78736965  1.77175914  1.75655062  1.74831455  1.73205081  1.72608848
  1.70251306  1.70084013  1.66003771  1.65903012  1.65703431  1.62964343
  1.62830468  1.59922548  1.51185789  1.49676654  1.48556271  1.4852969
  1.46385011  1.45010473  1.42373699  1.4110813   1.40329283  1.39875721
  1.38675049  1.37198868  1.36363636  1.36201045  1.34715063  1.34164079
  1.33103476  1.32287566  1.30654916  1.29986737  1.22293713  1.20185043
  1.2         1.18817705  1.17217053  1.15311332  1.14415511  1.13389342
  1.12724296  1.11417203  1.11066496  1.10468954  1.09544512  1.05246962
  1.0440738   1.03664211  1.03479296  1.02575529  0.98058068  0.97609216
  0.96225045  0.87038828  0.87006284  0.86204366  0.8542422   0.84664878
  0.83205029  0.81818182  0.81150267  0.80498447  0.79211803  0.73645969
  0.73029674  0.71842121  0.67671554  0.6704784   0.6644106   0.62114956
  0.61159284  0.58834841  0.58277152  0.57735027  0.56694671  0.55234477
  0.54321448  0.53881591  0.53452248  0.47036043  0.45834925  0.45454545
  0.44022545  0.38851434  0.38138504  0.37463432  0.37139068  0.36822985
  0.36514837  0.36214298  0.3592106   0.27975144  0.26832816  0.20628425
  0.19802951  0.19611614  0.19425717  0.19245009  0.18731716  0.18569534
  0.18411492  0.18257419  0.18107149  0.1796053   0.17817416  0.09578263
  0.0949158   0.09407209  0.09245003  0.09166985  0.09090909  0.086711
  0.         -0.08481889 -0.08804509 -0.08873565 -0.09325048 -0.09407209
 -0.0949158  -0.09759001 -0.1754116  -0.17817416 -0.18107149 -0.18411492
 -0.26832816 -0.27050089 -0.27500955 -0.27975144 -0.3380617  -0.35082321
 -0.36514837 -0.36822985 -0.37463432 -0.37796447 -0.44367825 -0.4472136
 -0.45454545 -0.45834925 -0.47036043 -0.47891314 -0.48795004 -0.49266464
 -0.52223297 -0.53452248 -0.53881591 -0.54321448 -0.64715023 -0.65275337
 -0.69652603 -0.72428597 -0.74278135 -0.76277007 -0.76337004 -0.77702869
 -0.79555728 -0.79862086 -0.80498447 -0.80812204 -0.81150267 -0.82502865
 -0.83925433 -0.87705802 -0.88388348 -0.89553347 -0.89802651 -0.91287093
 -0.93658581 -0.94491118 -0.97128586 -0.9918366  -1.00836835 -1.06066017
 -1.07349008 -1.25436302 -1.26750044 -1.2780193  -1.29099445 -1.49676654
 -1.4985373  -1.75655062 -1.76776695 -2.04939015 -2.09090909 -2.73861279]
Test metrics at specific given threshold:
accuracy: 0.9129157472417252
precision: 0.9401558948264547
recall: 0.8820220058256111
f1_score: 0.9100776832819577
fp_rate: 0.056167756878700195
tp_rate: 0.8820220058256111
std_accuracy: 0.008757232182082762
std_precision: 0.010715429862052832
std_recall: 0.014274897915021923
std_f1_score: 0.009369187109014071
std_fp_rate: 0.010085861032504214
std_tp_rate: 0.014274897915021923
TP: 439.75
TN: 470.427
FP: 27.994
FN: 58.829
