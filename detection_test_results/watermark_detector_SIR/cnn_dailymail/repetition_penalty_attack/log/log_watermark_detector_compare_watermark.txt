Dataset at data/generated_datasets/cnn_dailymail/repetition_penalty_attack/SIR/zephyr_compare_watermark exists, loading it
Results for finding the threshold already exist. Loading them...
Threshold for target FPR 0.05: 0.15204510052350506
Classifying the articles...
Test metrics:
accuracy: 0.742507522567703
precision: 0.9652517686741231
recall: 0.5029136193770074
f1_score: 0.6609940222377506
fp_rate: 0.018093810396570723
tp_rate: 0.5029136193770074
std_accuracy: 0.013292484744877469
std_precision: 0.011061845975591482
std_recall: 0.022300659480150798
std_f1_score: 0.01980133675878525
std_fp_rate: 0.005812653309007148
std_tp_rate: 0.022300659480150798
TP: 250.663
TN: 489.617
FP: 9.021
FN: 247.699
roc_auc: 0.9166002688107138
fpr: [0.         0.         0.         0.00200803 0.00200803 0.00401606
 0.00401606 0.0060241  0.0060241  0.00803213 0.00803213 0.01004016
 0.01004016 0.01405622 0.01405622 0.01606426 0.01606426 0.01807229
 0.01807229 0.02208835 0.02208835 0.02409639 0.02409639 0.02610442
 0.02610442 0.02811245 0.02811245 0.03012048 0.03012048 0.03212851
 0.03212851 0.03614458 0.03614458 0.03815261 0.03815261 0.04016064
 0.04016064 0.04216867 0.04216867 0.04417671 0.04417671 0.0502008
 0.0502008  0.05220884 0.05220884 0.0562249  0.0562249  0.05823293
 0.05823293 0.062249   0.062249   0.06425703 0.06425703 0.06827309
 0.06827309 0.07028112 0.07028112 0.07228916 0.07228916 0.07630522
 0.07630522 0.08232932 0.08232932 0.08634538 0.08634538 0.08835341
 0.08835341 0.09036145 0.09036145 0.09236948 0.09236948 0.09437751
 0.09437751 0.09638554 0.09638554 0.09839357 0.09839357 0.10240964
 0.10240964 0.10441767 0.10441767 0.1064257  0.1064257  0.10843373
 0.10843373 0.11044177 0.11044177 0.1124498  0.1124498  0.11445783
 0.11445783 0.11646586 0.11646586 0.12449799 0.12449799 0.12650602
 0.12650602 0.13052209 0.13052209 0.13654618 0.13654618 0.13855422
 0.13855422 0.14056225 0.14056225 0.14257028 0.14257028 0.14457831
 0.14457831 0.14658635 0.14658635 0.14859438 0.14859438 0.15261044
 0.15261044 0.15662651 0.15662651 0.1626506  0.1626506  0.16666667
 0.16666667 0.17068273 0.17068273 0.1746988  0.1746988  0.17871486
 0.17871486 0.18273092 0.18273092 0.18674699 0.18674699 0.19277108
 0.19277108 0.20481928 0.20481928 0.20682731 0.20682731 0.20883534
 0.20883534 0.21285141 0.21285141 0.21686747 0.21686747 0.2188755
 0.2188755  0.22088353 0.22088353 0.2248996  0.2248996  0.22690763
 0.22690763 0.23694779 0.23694779 0.24899598 0.24899598 0.25301205
 0.25301205 0.26305221 0.26305221 0.27710843 0.27710843 0.29718876
 0.29718876 0.30120482 0.30120482 0.31526104 0.31526104 0.32128514
 0.32128514 0.32329317 0.32329317 0.32730924 0.32730924 0.33534137
 0.33534137 0.33935743 0.33935743 0.34337349 0.34337349 0.34738956
 0.34738956 0.35943775 0.35943775 0.36345382 0.36345382 0.36746988
 0.36746988 0.37751004 0.37751004 0.40562249 0.40562249 0.41164659
 0.41164659 0.41566265 0.41566265 0.43373494 0.43373494 0.4497992
 0.4497992  0.45983936 0.45983936 0.47188755 0.47188755 0.47590361
 0.47590361 0.52409639 0.52409639 0.54618474 0.54618474 0.55421687
 0.55421687 0.57429719 0.57429719 0.60441767 0.60441767 0.62449799
 0.62449799 0.66064257 0.66064257 0.6626506  0.6626506  0.68875502
 0.68875502 0.73895582 0.73895582 0.75502008 0.75502008 0.8373494
 0.8373494  0.84538153 0.84538153 0.87951807 0.87951807 0.92168675
 0.92168675 1.        ]
tpr: [0.         0.00200401 0.18637275 0.18637275 0.20641283 0.20641283
 0.26252505 0.26252505 0.27855711 0.27855711 0.28056112 0.28056112
 0.33266533 0.33266533 0.35270541 0.35270541 0.41282565 0.41282565
 0.51903808 0.51903808 0.52304609 0.52304609 0.53907816 0.53907816
 0.56312625 0.56312625 0.57715431 0.57715431 0.58316633 0.58316633
 0.58917836 0.58917836 0.60521042 0.60521042 0.60721443 0.60721443
 0.61723447 0.61723447 0.6252505  0.6252505  0.63326653 0.63326653
 0.64729459 0.64729459 0.65330661 0.65330661 0.65731463 0.65731463
 0.67334669 0.67334669 0.6753507  0.6753507  0.68737475 0.68737475
 0.70941884 0.70941884 0.71142285 0.71142285 0.72144289 0.72144289
 0.7254509  0.7254509  0.72945892 0.72945892 0.73346693 0.73346693
 0.74749499 0.74749499 0.75350701 0.75350701 0.76152305 0.76152305
 0.76753507 0.76753507 0.77154309 0.77154309 0.77755511 0.77755511
 0.78557114 0.78557114 0.78757515 0.78757515 0.78957916 0.78957916
 0.79158317 0.79158317 0.79759519 0.79759519 0.80761523 0.80761523
 0.80961924 0.80961924 0.81963928 0.81963928 0.82364729 0.82364729
 0.8256513  0.8256513  0.82765531 0.82765531 0.82965932 0.82965932
 0.83366733 0.83366733 0.83567134 0.83567134 0.83767535 0.83767535
 0.84368737 0.84368737 0.84569138 0.84569138 0.84769539 0.84769539
 0.8496994  0.8496994  0.85170341 0.85170341 0.85571142 0.85571142
 0.85771543 0.85771543 0.85971944 0.85971944 0.86172345 0.86172345
 0.86372745 0.86372745 0.86573146 0.86573146 0.86973948 0.86973948
 0.87174349 0.87174349 0.87374749 0.87374749 0.8757515  0.8757515
 0.87975952 0.87975952 0.88176353 0.88176353 0.88577154 0.88577154
 0.88777555 0.88777555 0.89178357 0.89178357 0.89579158 0.89579158
 0.89779559 0.89779559 0.8997996  0.8997996  0.90581162 0.90581162
 0.90981964 0.90981964 0.91583166 0.91583166 0.91783567 0.91783567
 0.91983968 0.91983968 0.92184369 0.92184369 0.9238477  0.9238477
 0.9258517  0.9258517  0.93186373 0.93186373 0.93386774 0.93386774
 0.93587174 0.93587174 0.93787575 0.93787575 0.93987976 0.93987976
 0.94188377 0.94188377 0.94388778 0.94388778 0.94589178 0.94589178
 0.94789579 0.94789579 0.9498998  0.9498998  0.95190381 0.95190381
 0.95390782 0.95390782 0.95591182 0.95591182 0.95791583 0.95791583
 0.95991984 0.95991984 0.96192385 0.96192385 0.96392786 0.96392786
 0.96593186 0.96593186 0.96793587 0.96793587 0.96993988 0.96993988
 0.97194389 0.97194389 0.9739479  0.9739479  0.9759519  0.9759519
 0.97795591 0.97795591 0.98196393 0.98196393 0.98396794 0.98396794
 0.98597194 0.98597194 0.98797595 0.98797595 0.98997996 0.98997996
 0.99198397 0.99198397 0.99398798 0.99398798 0.99799599 0.99799599
 1.         1.        ]
thresholds: [            inf  5.73450452e-01  3.11957626e-01  3.11692807e-01
  3.03093514e-01  3.01929866e-01  2.78640001e-01  2.78268548e-01
  2.65995102e-01  2.65200362e-01  2.64390501e-01  2.64200450e-01
  2.44897631e-01  2.44368145e-01  2.41767691e-01  2.41533006e-01
  2.23260543e-01  2.23217302e-01  1.94412259e-01  1.92787339e-01
  1.92052890e-01  1.91893040e-01  1.84369581e-01  1.84367181e-01
  1.79739318e-01  1.79696870e-01  1.73628642e-01  1.73579653e-01
  1.71715298e-01  1.71570294e-01  1.70878535e-01  1.70229243e-01
  1.67081929e-01  1.66985997e-01  1.66675283e-01  1.66611371e-01
  1.64825943e-01  1.64530066e-01  1.63523403e-01  1.62704974e-01
  1.60657636e-01  1.59077105e-01  1.55763313e-01  1.55524590e-01
  1.52183422e-01  1.49211870e-01  1.48675868e-01  1.47316893e-01
  1.41052469e-01  1.40602728e-01  1.40543623e-01  1.40090873e-01
  1.38113173e-01  1.36699203e-01  1.29899513e-01  1.29776240e-01
  1.29754242e-01  1.29719437e-01  1.28156155e-01  1.25802192e-01
  1.25654130e-01  1.24216888e-01  1.22799842e-01  1.21816380e-01
  1.18772105e-01  1.18096002e-01  1.15327354e-01  1.15167734e-01
  1.14270902e-01  1.13997168e-01  1.09778457e-01  1.09727876e-01
  1.09182986e-01  1.08723570e-01  1.07553556e-01  1.07373422e-01
  1.06579412e-01  1.04779306e-01  1.03877196e-01  1.03837513e-01
  1.03699584e-01  1.03525150e-01  1.02756779e-01  1.02474263e-01
  1.02430330e-01  1.02364071e-01  1.01729132e-01  1.00995878e-01
  9.67728239e-02  9.63641336e-02  9.46454749e-02  9.42578639e-02
  9.03404046e-02  8.74836567e-02  8.57478829e-02  8.57284702e-02
  8.56287365e-02  8.45204385e-02  8.38372409e-02  8.18231372e-02
  8.17943131e-02  8.08421206e-02  8.06923014e-02  8.00991573e-02
  7.91156737e-02  7.86690317e-02  7.84250620e-02  7.83216682e-02
  7.74467548e-02  7.62878028e-02  7.55490035e-02  7.53316443e-02
  7.40667870e-02  7.35678679e-02  7.35229753e-02  7.30320763e-02
  7.28813699e-02  7.19604692e-02  7.08090443e-02  7.03920841e-02
  6.93098478e-02  6.77156065e-02  6.76600941e-02  6.74821138e-02
  6.73415902e-02  6.60403420e-02  6.58074387e-02  6.50369416e-02
  6.42900003e-02  6.12722156e-02  5.81789326e-02  5.75084333e-02
  5.69615390e-02  5.49799189e-02  5.45966695e-02  5.36854558e-02
  5.30584976e-02  5.29883268e-02  5.08479010e-02  4.95986348e-02
  4.89255985e-02  4.85434063e-02  4.78813472e-02  4.78071369e-02
  4.75676067e-02  4.64211362e-02  4.53049319e-02  4.52165118e-02
  4.43547870e-02  4.39773544e-02  4.34115963e-02  4.08346325e-02
  4.07309725e-02  3.78734621e-02  3.63341723e-02  3.59649834e-02
  3.58129168e-02  3.07611202e-02  2.95189960e-02  2.70541360e-02
  2.63263030e-02  2.06323764e-02  2.01950351e-02  1.88894481e-02
  1.82484876e-02  1.47691613e-02  1.35404291e-02  1.33071930e-02
  1.30440286e-02  1.21094208e-02  1.03092851e-02  8.62599568e-03
  7.74876767e-03  3.45446223e-03  3.02608480e-03  8.41292373e-04
  4.89892231e-04 -5.71130295e-04 -1.20776587e-03 -3.36864906e-03
 -5.53501773e-03 -9.75861377e-03 -1.01140551e-02 -1.31555924e-02
 -1.37427925e-02 -1.41955646e-02 -1.50167000e-02 -1.65105988e-02
 -1.68369158e-02 -2.08471056e-02 -2.09594454e-02 -2.23029149e-02
 -2.24000716e-02 -2.33938497e-02 -2.40025208e-02 -2.88597147e-02
 -2.92433865e-02 -3.20955846e-02 -3.29898632e-02 -3.57608144e-02
 -3.58685322e-02 -3.92536737e-02 -4.14218005e-02 -4.29809353e-02
 -4.32154448e-02 -5.71391672e-02 -5.73985456e-02 -6.22892350e-02
 -6.22985750e-02 -6.59386189e-02 -6.61356483e-02 -7.10662618e-02
 -7.13631438e-02 -7.84239021e-02 -7.87215754e-02 -8.27559219e-02
 -8.28741987e-02 -9.32148625e-02 -9.38448434e-02 -9.38626151e-02
 -9.43012961e-02 -1.05542813e-01 -1.05574972e-01 -1.24692815e-01
 -1.24701538e-01 -1.31317845e-01 -1.32065936e-01 -1.64440870e-01
 -1.64866914e-01 -1.67213451e-01 -1.69645536e-01 -1.85075218e-01
 -1.86766164e-01 -2.26418596e-01 -2.29209549e-01 -4.01927570e-01]
Test metrics at specific given threshold:
accuracy: 0.7998355065195587
precision: 0.9255781550191609
recall: 0.6519033966230688
f1_score: 0.7647976819094925
fp_rate: 0.0523893657130031
tp_rate: 0.6519033966230688
std_accuracy: 0.01216232318815161
std_precision: 0.013975201550566408
std_recall: 0.02043538429380333
std_f1_score: 0.015403637319803076
std_fp_rate: 0.010050222030171365
std_tp_rate: 0.02043538429380333
TP: 324.821
TN: 472.615
FP: 26.126
FN: 173.438
