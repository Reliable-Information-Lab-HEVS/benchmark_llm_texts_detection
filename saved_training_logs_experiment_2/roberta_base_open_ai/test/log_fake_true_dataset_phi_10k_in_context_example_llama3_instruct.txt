Flipping labels for the dataset
Evaluating the best model on the test set of dataset fake_true_datasets/modified_datasets/fake_true_dataset_phi_10k_in_context_example_llama3_instruct...
Test metrics:
accuracy: 0.721228
precision: 0.8530645891498636
recall: 0.5335787929296295
f1_score: 0.6562319685847524
fp_rate: 0.09163496609707365
tp_rate: 0.5335787929296295
std_accuracy: 0.014040655825138665
std_precision: 0.020455297694424092
std_recall: 0.02253604782903606
std_f1_score: 0.019530990045656227
std_fp_rate: 0.013007601530184995
std_tp_rate: 0.02253604782903606
TP: 454.794
TN: 266.434
FP: 232.885
FN: 45.887
roc_auc: 0.829208
fpr: [0.    0.    0.    0.002 0.002 0.004 0.004 0.006 0.006 0.008 0.008 0.01
 0.01  0.012 0.012 0.014 0.014 0.016 0.016 0.018 0.018 0.02  0.02  0.022
 0.022 0.024 0.024 0.026 0.026 0.028 0.028 0.03  0.03  0.032 0.032 0.034
 0.034 0.036 0.036 0.038 0.038 0.04  0.04  0.044 0.044 0.046 0.046 0.048
 0.048 0.05  0.05  0.052 0.052 0.054 0.054 0.056 0.056 0.062 0.062 0.064
 0.064 0.068 0.068 0.07  0.07  0.072 0.072 0.074 0.074 0.076 0.076 0.078
 0.078 0.08  0.08  0.082 0.082 0.084 0.084 0.086 0.086 0.088 0.088 0.09
 0.09  0.092 0.092 0.096 0.096 0.102 0.102 0.104 0.104 0.106 0.106 0.108
 0.108 0.11  0.11  0.114 0.114 0.116 0.116 0.118 0.118 0.122 0.122 0.124
 0.124 0.128 0.128 0.13  0.13  0.132 0.132 0.136 0.136 0.138 0.138 0.14
 0.14  0.142 0.142 0.15  0.15  0.152 0.152 0.154 0.154 0.156 0.156 0.158
 0.158 0.168 0.168 0.172 0.172 0.174 0.174 0.178 0.178 0.184 0.184 0.188
 0.188 0.19  0.19  0.196 0.196 0.198 0.198 0.2   0.2   0.204 0.204 0.21
 0.21  0.212 0.212 0.214 0.214 0.22  0.22  0.222 0.222 0.228 0.228 0.232
 0.232 0.238 0.238 0.242 0.242 0.246 0.246 0.248 0.248 0.25  0.25  0.26
 0.26  0.272 0.272 0.274 0.274 0.276 0.276 0.278 0.278 0.282 0.282 0.284
 0.284 0.288 0.288 0.294 0.294 0.296 0.296 0.298 0.298 0.312 0.312 0.32
 0.32  0.322 0.322 0.332 0.332 0.334 0.334 0.342 0.342 0.344 0.344 0.356
 0.356 0.36  0.36  0.366 0.366 0.368 0.368 0.374 0.374 0.384 0.384 0.39
 0.39  0.396 0.396 0.4   0.4   0.402 0.402 0.414 0.414 0.418 0.418 0.424
 0.424 0.426 0.426 0.442 0.442 0.448 0.448 0.45  0.45  0.454 0.454 0.456
 0.456 0.472 0.472 0.474 0.474 0.488 0.488 0.49  0.49  0.492 0.492 0.506
 0.506 0.51  0.51  0.514 0.514 0.516 0.516 0.518 0.518 0.522 0.522 0.528
 0.528 0.54  0.54  0.558 0.558 0.578 0.578 0.598 0.598 0.606 0.606 0.61
 0.61  0.612 0.612 0.614 0.614 0.62  0.62  0.624 0.624 0.626 0.626 0.664
 0.664 0.678 0.678 0.686 0.686 0.696 0.696 0.702 0.702 0.73  0.73  0.738
 0.738 0.75  0.75  0.766 0.766 0.768 0.768 0.776 0.776 0.786 0.786 0.79
 0.79  0.806 0.806 0.836 0.836 0.838 0.838 0.856 0.856 0.868 0.868 0.906
 0.906 0.908 0.908 0.922 0.922 0.934 0.934 0.942 0.942 1.   ]
tpr: [0.    0.002 0.054 0.054 0.076 0.076 0.154 0.154 0.178 0.178 0.18  0.18
 0.216 0.216 0.248 0.248 0.252 0.252 0.266 0.266 0.284 0.284 0.296 0.296
 0.302 0.302 0.318 0.318 0.342 0.342 0.348 0.348 0.358 0.358 0.364 0.364
 0.372 0.372 0.376 0.376 0.378 0.378 0.386 0.386 0.396 0.396 0.398 0.398
 0.41  0.41  0.414 0.414 0.42  0.42  0.43  0.43  0.436 0.436 0.44  0.44
 0.444 0.444 0.452 0.452 0.454 0.454 0.468 0.468 0.47  0.47  0.476 0.476
 0.488 0.488 0.494 0.494 0.496 0.496 0.508 0.508 0.516 0.516 0.524 0.524
 0.528 0.528 0.552 0.552 0.56  0.56  0.562 0.562 0.576 0.576 0.58  0.58
 0.588 0.588 0.592 0.592 0.598 0.598 0.61  0.61  0.612 0.612 0.62  0.62
 0.622 0.622 0.626 0.626 0.644 0.644 0.646 0.646 0.652 0.652 0.658 0.658
 0.664 0.664 0.666 0.666 0.668 0.668 0.67  0.67  0.672 0.672 0.678 0.678
 0.68  0.68  0.686 0.686 0.688 0.688 0.704 0.704 0.706 0.706 0.71  0.71
 0.712 0.712 0.714 0.714 0.716 0.716 0.718 0.718 0.72  0.72  0.728 0.728
 0.73  0.73  0.734 0.734 0.738 0.738 0.74  0.74  0.744 0.744 0.75  0.75
 0.752 0.752 0.754 0.754 0.756 0.756 0.76  0.76  0.762 0.762 0.764 0.764
 0.766 0.766 0.768 0.768 0.77  0.77  0.774 0.774 0.776 0.776 0.778 0.778
 0.78  0.78  0.792 0.792 0.794 0.794 0.798 0.798 0.8   0.8   0.806 0.806
 0.808 0.808 0.812 0.812 0.816 0.816 0.818 0.818 0.82  0.82  0.822 0.822
 0.824 0.824 0.826 0.826 0.83  0.83  0.832 0.832 0.838 0.838 0.842 0.842
 0.846 0.846 0.848 0.848 0.85  0.85  0.852 0.852 0.854 0.854 0.856 0.856
 0.858 0.858 0.86  0.86  0.862 0.862 0.864 0.864 0.866 0.866 0.868 0.868
 0.87  0.87  0.874 0.874 0.876 0.876 0.88  0.88  0.882 0.882 0.884 0.884
 0.886 0.886 0.888 0.888 0.89  0.89  0.892 0.892 0.896 0.896 0.9   0.9
 0.908 0.908 0.91  0.91  0.912 0.912 0.916 0.916 0.92  0.92  0.924 0.924
 0.93  0.93  0.932 0.932 0.936 0.936 0.94  0.94  0.942 0.942 0.944 0.944
 0.946 0.946 0.948 0.948 0.952 0.952 0.958 0.958 0.962 0.962 0.964 0.964
 0.966 0.966 0.968 0.968 0.97  0.97  0.972 0.972 0.974 0.974 0.976 0.976
 0.978 0.978 0.98  0.98  0.982 0.982 0.984 0.984 0.988 0.988 0.99  0.99
 0.992 0.992 0.994 0.994 0.996 0.996 0.998 0.998 1.    1.   ]
thresholds: [        inf  4.7029433   4.441763    4.420733    4.18869     4.161752
  3.5174394   3.3804214   3.1819816   3.176591    3.1630535   3.0619423
  2.621205    2.5971656   2.3192964   2.2664266   2.229943    2.1478696
  2.0064375   1.9928658   1.9121765   1.9041985   1.8383332   1.822807
  1.782577    1.725924    1.6250474   1.6118169   1.4708401   1.4614749
  1.4281476   1.4257184   1.3122361   1.30307     1.285247    1.2673293
  1.221596    1.2211485   1.1672049   1.1615539   1.1544363   1.152836
  1.1155322   1.0877966   0.97606933  0.93790907  0.91261727  0.9044099
  0.8225148   0.8123351   0.7976683   0.78627986  0.772597    0.7712801
  0.6960443   0.67623216  0.63057166  0.5481038   0.5284985   0.51929474
  0.5076298   0.4941866   0.40755317  0.4075253   0.38639316  0.3708031
  0.26921645  0.26702356  0.22667857  0.22470455  0.20257768  0.20085679
  0.15154672  0.14604723  0.11940303  0.08913606  0.0705854   0.06057579
  0.045628    0.03955255  0.02951759  0.01623427 -0.00799592 -0.02355053
 -0.03146722 -0.03148035 -0.13072515 -0.13387188 -0.180541   -0.21576399
 -0.23115584 -0.23933867 -0.32995945 -0.3879348  -0.40382114 -0.40650493
 -0.419475   -0.42663807 -0.4381119  -0.47285935 -0.49643454 -0.4968989
 -0.52552426 -0.5382139  -0.5512694  -0.5545728  -0.60637105 -0.6073186
 -0.60954434 -0.6139102  -0.6160606  -0.6315277  -0.7002691  -0.745757
 -0.7538394  -0.7726854  -0.8198039  -0.8238732  -0.8407974  -0.85072464
 -0.86643463 -0.86819965 -0.89941084 -0.9296862  -0.93613076 -0.93856454
 -0.9403828  -0.94145155 -0.94823956 -0.9615762  -0.98860824 -0.99332595
 -0.9943     -1.0233307  -1.0928518  -1.1064986  -1.1093653  -1.110003
 -1.1541824  -1.1714735  -1.1724038  -1.1800573  -1.188253   -1.1972017
 -1.2035406  -1.2146547  -1.2231791  -1.2336916  -1.2380443  -1.2481776
 -1.2482917  -1.2503073  -1.2579756  -1.2828667  -1.2930269  -1.3108587
 -1.3144656  -1.3154624  -1.3333765  -1.336197   -1.3572778  -1.4067483
 -1.4121774  -1.4145364  -1.426385   -1.4419494  -1.4727029  -1.4831809
 -1.4854884  -1.4994833  -1.5045509  -1.5101091  -1.5119104  -1.5151805
 -1.5193063  -1.5280339  -1.5308598  -1.5525895  -1.560069   -1.5958837
 -1.6238735  -1.6580322  -1.6612891  -1.6643306  -1.6667144  -1.6768757
 -1.7029107  -1.7049516  -1.7059765  -1.7175311  -1.7222557  -1.7259252
 -1.7266395  -1.7291895  -1.7830689  -1.7927959  -1.7940323  -1.7951006
 -1.8028662  -1.8110363  -1.8125104  -1.8677078  -1.8868504  -1.9365232
 -1.9521619  -1.9690943  -1.9975982  -2.0219631  -2.0313091  -2.0397213
 -2.0450802  -2.0826714  -2.0866094  -2.0895066  -2.090444   -2.1549397
 -2.1558878  -2.1591706  -2.1601346  -2.1737587  -2.1927574  -2.2030056
 -2.2073874  -2.2228024  -2.2365115  -2.269996   -2.292379   -2.3150313
 -2.3235888  -2.3456302  -2.3471618  -2.376842   -2.377777   -2.383174
 -2.3889537  -2.413377   -2.4224737  -2.4306004  -2.4419289  -2.463528
 -2.4720078  -2.4789765  -2.4968874  -2.549403   -2.55927    -2.5809124
 -2.5936837  -2.6192036  -2.6333485  -2.649203   -2.6493921  -2.6598241
 -2.660362   -2.7303817  -2.7485843  -2.7487237  -2.752466   -2.8096414
 -2.8178666  -2.8249323  -2.8263447  -2.8326411  -2.8363256  -2.876838
 -2.914884   -2.9391065  -2.9400315  -2.9785662  -2.9805279  -2.9864726
 -2.993911   -3.0007997  -3.0059538  -3.0202544  -3.0318952  -3.0413144
 -3.0683794  -3.0940223  -3.1006658  -3.13869    -3.1390436  -3.2337239
 -3.2467291  -3.3073509  -3.3384113  -3.3685687  -3.3854244  -3.4198494
 -3.4323092  -3.4328842  -3.438591   -3.440691   -3.4460747  -3.49112
 -3.5056322  -3.5285285  -3.5341716  -3.545138   -3.545783   -3.6708152
 -3.6712751  -3.7022457  -3.7031412  -3.7664027  -3.7680693  -3.8201537
 -3.8667986  -3.898378   -3.9097524  -3.987992   -3.994313   -4.0229573
 -4.0268135  -4.054068   -4.062139   -4.13018    -4.1443186  -4.1708517
 -4.173057   -4.1862416  -4.1881256  -4.211      -4.221837   -4.2392716
 -4.2484546  -4.3101664  -4.3172235  -4.3970113  -4.410571   -4.418841
 -4.424814   -4.4578447  -4.4651227  -4.4867406  -4.493652   -4.5822544
 -4.586071   -4.593147   -4.595698   -4.6102686  -4.6130304  -4.6379085
 -4.6383     -4.6664844  -4.6674666  -4.717207  ]
Test metrics at specific given threshold:
accuracy: 0.7647919999999999
precision: 0.7980711808499554
recall: 0.709637720816678
f1_score: 0.7510737200818642
fp_rate: 0.17995666489409234
tp_rate: 0.709637720816678
std_accuracy: 0.013805025751515293
std_precision: 0.019231576431673038
std_recall: 0.020873325167890193
std_f1_score: 0.01650372922000068
std_fp_rate: 0.01686231182694403
std_tp_rate: 0.020873325167890193
TP: 409.509
TN: 355.283
FP: 145.348
FN: 89.86
